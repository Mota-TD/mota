import{b as G,r as i,j as e,S as O}from"./index-jJjkrASA.js";import{p as g}from"./api-DUmAbDc_.js";import{F as l}from"./index-CNgAusFm.js";import{B as o}from"./button-Bv8EyRxh.js";import{R as Z}from"./PlusOutlined-Bh2Mv01n.js";import{I as x}from"./index-DR1THxsW.js";import{R as J}from"./SearchOutlined-OiCr0NYv.js";import{S as Q}from"./index-DDqd5aTF.js";import{R as U,a as W}from"./UnorderedListOutlined-BB_tuJyc.js";import{E as b}from"./DownOutlined-CN1mv8sD.js";import{M as k}from"./index--XrJVTfB.js";import{R as X,C as Y}from"./row-DbvWXo5m.js";import{C as P}from"./index-CiIGZjGq.js";import{A as R}from"./index-CzYeSCDM.js";import{R as A,a as M}from"./StarOutlined-BMYNSswx.js";import{D as S}from"./index-BUg6PNCH.js";import{R as T}from"./MoreOutlined-CjOKr4kg.js";import{P as F}from"./progress-BfLFEfyG.js";import{s as c}from"./index-C54hh6U9.js";import{R as ee}from"./EditOutlined-H6Ny8KCv.js";import{R as se}from"./SettingOutlined-CawUlI4j.js";import{R as te}from"./DeleteOutlined-KwwWlgLe.js";import{T as re}from"./index-C-XfQ0lz.js";import"./getAllowClear-DijkFjz0.js";import"./compact-item-CfP0ZfjF.js";import"./CloseCircleFilled-DzUWwAnM.js";import"./useForm-PTvZdMqb.js";import"./CheckCircleFilled-C1tkfSYQ.js";import"./ExclamationCircleFilled-CjD5Kf6C.js";import"./RightOutlined-CFLGXWAw.js";import"./Input-BYqifNCC.js";import"./TextArea-D2UEp3z5.js";import"./EllipsisOutlined-Bct-hJoY.js";import"./PurePanel-BjAOE1jZ.js";import"./move-DCQK6w6D.js";import"./CheckOutlined-CH83bvZX.js";import"./CloseOutlined-JFFLTca6.js";import"./ActionButton-BlIwnF7n.js";import"./Skeleton-CpdpnCda.js";import"./index-F9YRoaSd.js";import"./fade-5De2vm1n.js";import"./useClosable-Dcdur4ya.js";import"./extendsObject-78o_rR5W.js";import"./index-KYPfHnUh.js";import"./index-D31JVHEt.js";import"./LeftOutlined-DSxe2Naa.js";import"./index-DEZvTLAg.js";const oe="_projects_14iwf_1",ie="_header_14iwf_9",ae="_toolbar_14iwf_35",le="_filters_14iwf_49",ce="_viewToggle_14iwf_59",ne="_loading_14iwf_69",me="_projectCard_14iwf_85",de="_cardHeader_14iwf_103",pe="_cardActions_14iwf_117",fe="_cardBody_14iwf_139",xe="_projectName_14iwf_147",je="_projectKey_14iwf_161",he="_projectDesc_14iwf_173",_e="_cardFooter_14iwf_195",ue="_projectMeta_14iwf_205",ge="_memberCount_14iwf_219",we="_listView_14iwf_231",ye="_listItem_14iwf_243",Ie="_listItemContent_14iwf_259",Ce="_listItemInfo_14iwf_271",ve="_listItemHeader_14iwf_281",Ne="_listItemMeta_14iwf_307",be="_listItemProgress_14iwf_323",ke="_listItemActions_14iwf_331",Pe="_formActions_14iwf_353",t={projects:oe,header:ie,toolbar:ae,filters:le,viewToggle:ce,loading:ne,projectCard:me,cardHeader:de,cardActions:pe,cardBody:fe,projectName:xe,projectKey:je,projectDesc:he,cardFooter:_e,projectMeta:ue,memberCount:ge,listView:we,listItem:ye,listItemContent:Ie,listItemInfo:Ce,listItemHeader:ve,listItemMeta:Ne,listItemProgress:be,listItemActions:ke,formActions:Pe},Is=()=>{const d=G(),[$,w]=i.useState(!0),[j,y]=i.useState([]),[h,E]=i.useState([]),[_,I]=i.useState("grid"),[n,D]=i.useState(""),[p,V]=i.useState("all"),[H,m]=i.useState(!1),[f]=l.useForm();i.useEffect(()=>{u()},[]),i.useEffect(()=>{z()},[j,n,p]);const u=async()=>{w(!0);try{const s=await g.getProjects();y(s.data.list||s.data)}catch(s){console.error("Failed to load projects:",s)}finally{w(!1)}},z=()=>{let s=[...j];n&&(s=s.filter(r=>r.name.toLowerCase().includes(n.toLowerCase())||r.key.toLowerCase().includes(n.toLowerCase()))),p!=="all"&&(s=s.filter(r=>r.status===p)),E(s)},L=async s=>{try{await g.createProject(s),c.success("项目创建成功"),m(!1),f.resetFields(),u()}catch(r){c.error(r.message||"创建失败")}},C=async(s,r)=>{try{y(j.map(a=>a.id===s?{...a,starred:!r}:a)),c.success(r?"已取消收藏":"已收藏")}catch{c.error("操作失败")}},B=async s=>{k.confirm({title:"确认删除",content:"删除项目后，所有相关数据将被清除，此操作不可恢复。",okText:"确认删除",okType:"danger",cancelText:"取消",onOk:async()=>{try{await g.deleteProject(s),c.success("项目已删除"),u()}catch{c.error("删除失败")}}})},v=s=>{const a={active:{color:"green",text:"进行中"},completed:{color:"blue",text:"已完成"},archived:{color:"default",text:"已归档"}}[s]||{color:"default",text:s};return e.jsx(re,{color:a.color,children:a.text})},N=s=>[{key:"edit",icon:e.jsx(ee,{}),label:"编辑项目",onClick:()=>d(`/projects/${s.id}/settings`)},{key:"settings",icon:e.jsx(se,{}),label:"项目设置",onClick:()=>d("/settings")},{type:"divider"},{key:"delete",icon:e.jsx(te,{}),label:"删除项目",danger:!0,onClick:()=>B(s.id)}],K=()=>e.jsx(X,{gutter:[16,16],children:h.map(s=>e.jsx(Y,{xs:24,sm:12,lg:8,xl:6,children:e.jsxs(P,{className:t.projectCard,hoverable:!0,onClick:()=>d(`/projects/${s.id}`),children:[e.jsxs("div",{className:t.cardHeader,children:[e.jsx(R,{shape:"square",size:48,style:{backgroundColor:s.color||"#1677ff"},children:s.name.charAt(0)}),e.jsxs("div",{className:t.cardActions,children:[e.jsx(o,{type:"text",size:"small",icon:s.starred?e.jsx(A,{style:{color:"#faad14"}}):e.jsx(M,{}),onClick:r=>{r.stopPropagation(),C(s.id,s.starred)}}),e.jsx(S,{menu:{items:N(s)},trigger:["click"],placement:"bottomRight",children:e.jsx(o,{type:"text",size:"small",icon:e.jsx(T,{}),onClick:r=>r.stopPropagation()})})]})]}),e.jsxs("div",{className:t.cardBody,children:[e.jsx("h3",{className:t.projectName,children:s.name}),e.jsx("p",{className:t.projectKey,children:s.key}),e.jsx("p",{className:t.projectDesc,children:s.description||"暂无描述"})]}),e.jsxs("div",{className:t.cardFooter,children:[e.jsxs("div",{className:t.projectMeta,children:[v(s.status),e.jsxs("span",{className:t.memberCount,children:[s.memberCount," 成员"]})]}),e.jsx(F,{percent:s.progress||0,size:"small",showInfo:!1,strokeColor:"#1677ff"})]})]})},s.id))}),q=()=>e.jsx("div",{className:t.listView,children:h.map(s=>e.jsx(P,{className:t.listItem,hoverable:!0,onClick:()=>d(`/projects/${s.id}`),children:e.jsxs("div",{className:t.listItemContent,children:[e.jsx(R,{shape:"square",size:40,style:{backgroundColor:s.color||"#1677ff"},children:s.name.charAt(0)}),e.jsxs("div",{className:t.listItemInfo,children:[e.jsxs("div",{className:t.listItemHeader,children:[e.jsx("h3",{children:s.name}),e.jsx("span",{className:t.projectKey,children:s.key})]}),e.jsx("p",{className:t.projectDesc,children:s.description||"暂无描述"})]}),e.jsxs("div",{className:t.listItemMeta,children:[v(s.status),e.jsxs("span",{children:[s.memberCount," 成员"]}),e.jsxs("span",{children:[s.issueCount," 事项"]})]}),e.jsx("div",{className:t.listItemProgress,children:e.jsx(F,{percent:s.progress||0,size:"small",strokeColor:"#1677ff"})}),e.jsxs("div",{className:t.listItemActions,children:[e.jsx(o,{type:"text",icon:s.starred?e.jsx(A,{style:{color:"#faad14"}}):e.jsx(M,{}),onClick:r=>{r.stopPropagation(),C(s.id,s.starred)}}),e.jsx(S,{menu:{items:N(s)},trigger:["click"],placement:"bottomRight",children:e.jsx(o,{type:"text",icon:e.jsx(T,{}),onClick:r=>r.stopPropagation()})})]})]})},s.id))});return e.jsxs("div",{className:t.projects,children:[e.jsxs("div",{className:t.header,children:[e.jsx("h2",{children:"项目列表"}),e.jsx(o,{type:"primary",icon:e.jsx(Z,{}),onClick:()=>m(!0),children:"创建项目"})]}),e.jsxs("div",{className:t.toolbar,children:[e.jsxs("div",{className:t.filters,children:[e.jsx(x,{placeholder:"搜索项目",prefix:e.jsx(J,{}),value:n,onChange:s=>D(s.target.value),style:{width:240},allowClear:!0}),e.jsx(Q,{value:p,onChange:V,style:{width:120},options:[{value:"all",label:"全部状态"},{value:"active",label:"进行中"},{value:"completed",label:"已完成"},{value:"archived",label:"已归档"}]})]}),e.jsxs("div",{className:t.viewToggle,children:[e.jsx(o,{type:_==="grid"?"primary":"default",icon:e.jsx(U,{}),onClick:()=>I("grid")}),e.jsx(o,{type:_==="list"?"primary":"default",icon:e.jsx(W,{}),onClick:()=>I("list")})]})]}),$?e.jsx("div",{className:t.loading,children:e.jsx(O,{size:"large"})}):h.length===0?e.jsx(b,{description:"暂无项目",image:b.PRESENTED_IMAGE_SIMPLE,children:e.jsx(o,{type:"primary",onClick:()=>m(!0),children:"创建第一个项目"})}):_==="grid"?K():q(),e.jsx(k,{title:"创建项目",open:H,onCancel:()=>{m(!1),f.resetFields()},footer:null,width:520,children:e.jsxs(l,{form:f,layout:"vertical",onFinish:L,children:[e.jsx(l.Item,{name:"name",label:"项目名称",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(x,{placeholder:"请输入项目名称"})}),e.jsx(l.Item,{name:"key",label:"项目标识",rules:[{required:!0,message:"请输入项目标识"},{pattern:/^[A-Z][A-Z0-9]*$/,message:"项目标识必须以大写字母开头，只能包含大写字母和数字"}],children:e.jsx(x,{placeholder:"如：PROJ"})}),e.jsx(l.Item,{name:"description",label:"项目描述",children:e.jsx(x.TextArea,{rows:3,placeholder:"请输入项目描述"})}),e.jsx(l.Item,{children:e.jsxs("div",{className:t.formActions,children:[e.jsx(o,{onClick:()=>{m(!1),f.resetFields()},children:"取消"}),e.jsx(o,{type:"primary",htmlType:"submit",children:"创建"})]})})]})})]})};export{Is as default};

import{r as e,f as ne,m as se,h as ae,i as ie,v as le,C as q,c as T,l as ce}from"./index-jJjkrASA.js";import{s as de,I as ue,m as K,K as ge}from"./getAllowClear-DijkFjz0.js";import{e as me,t as pe}from"./compact-item-CfP0ZfjF.js";import{P as ve}from"./index-D31JVHEt.js";const H=e.createContext({}),fe=t=>{const{antCls:r,componentCls:a,iconCls:o,avatarBg:n,avatarColor:d,containerSize:y,containerSizeLG:u,containerSizeSM:x,textFontSize:z,textFontSizeLG:S,textFontSizeSM:M,iconFontSize:G,iconFontSizeLG:v,iconFontSizeSM:N,borderRadius:h,borderRadiusLG:b,borderRadiusSM:I,lineWidth:s,lineType:C}=t,f=(O,E,R,$)=>({width:O,height:O,borderRadius:"50%",fontSize:E,[`&${a}-square`]:{borderRadius:$},[`&${a}-icon`]:{fontSize:R,[`> ${o}`]:{margin:0}}});return{[a]:Object.assign(Object.assign(Object.assign(Object.assign({},ae(t)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:d,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:n,border:`${ie(s)} ${C} transparent`,"&-image":{background:"transparent"},[`${r}-image-img`]:{display:"block"}}),f(y,z,G,h)),{"&-lg":Object.assign({},f(u,S,v,b)),"&-sm":Object.assign({},f(x,M,N,I)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},Se=t=>{const{componentCls:r,groupBorderColor:a,groupOverlapping:o,groupSpace:n}=t;return{[`${r}-group`]:{display:"inline-flex",[r]:{borderColor:a},"> *:not(:first-child)":{marginInlineStart:o}},[`${r}-group-popover`]:{[`${r} + ${r}`]:{marginInlineStart:n}}}},he=t=>{const{controlHeight:r,controlHeightLG:a,controlHeightSM:o,fontSize:n,fontSizeLG:d,fontSizeXL:y,fontSizeHeading3:u,marginXS:x,marginXXS:z,colorBorderBg:S}=t;return{containerSize:r,containerSizeLG:a,containerSizeSM:o,textFontSize:n,textFontSizeLG:n,textFontSizeSM:n,iconFontSize:Math.round((d+y)/2),iconFontSizeLG:u,iconFontSizeSM:n,groupSpace:z,groupOverlapping:-x,groupBorderColor:S}},D=ne("Avatar",t=>{const{colorTextLightSolid:r,colorTextPlaceholder:a}=t,o=se(t,{avatarBg:a,avatarColor:r});return[fe(o),Se(o)]},he);var Ce=function(t,r){var a={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&r.indexOf(o)<0&&(a[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(a[o[n]]=t[o[n]]);return a};const J=e.forwardRef((t,r)=>{const{prefixCls:a,shape:o,size:n,src:d,srcSet:y,icon:u,className:x,rootClassName:z,style:S,alt:M,draggable:G,children:v,crossOrigin:N,gap:h=4,onError:b}=t,I=Ce(t,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","style","alt","draggable","children","crossOrigin","gap","onError"]),[s,C]=e.useState(1),[f,O]=e.useState(!1),[E,R]=e.useState(!0),$=e.useRef(null),j=e.useRef(null),F=le(r,$),{getPrefixCls:P,avatar:m}=e.useContext(q),g=e.useContext(H),w=()=>{if(!j.current||!$.current)return;const l=j.current.offsetWidth,i=$.current.offsetWidth;l!==0&&i!==0&&h*2<i&&C(i-h*2<l?(i-h*2)/l:1)};e.useEffect(()=>{O(!0)},[]),e.useEffect(()=>{R(!0),C(1)},[d]),e.useEffect(w,[h]);const B=()=>{b?.()!==!1&&R(!1)},c=me(l=>{var i,L;return(L=(i=n??g?.size)!==null&&i!==void 0?i:l)!==null&&L!==void 0?L:"default"}),_=Object.keys(typeof c=="object"?c||{}:{}).some(l=>["xs","sm","md","lg","xl","xxl"].includes(l)),A=de(_),Q=e.useMemo(()=>{if(typeof c!="object")return{};const l=ue.find(L=>A[L]),i=c[l];return i?{width:i,height:i,fontSize:i&&(u||v)?i/2:18}:{}},[A,c,u,v]),p=P("avatar",a),V=K(p),[U,Y,Z]=D(p,V),ee=T({[`${p}-lg`]:c==="large",[`${p}-sm`]:c==="small"}),W=e.isValidElement(d),te=o||g?.shape||"circle",oe=T(p,ee,m?.className,`${p}-${te}`,{[`${p}-image`]:W||d&&E,[`${p}-icon`]:!!u},Z,V,x,z,Y),re=typeof c=="number"?{width:c,height:c,fontSize:u?c/2:18}:{};let k;if(typeof d=="string"&&E)k=e.createElement("img",{src:d,draggable:G,srcSet:y,onError:B,alt:M,crossOrigin:N});else if(W)k=d;else if(u)k=u;else if(f||s!==1){const l=`scale(${s})`,i={msTransform:l,WebkitTransform:l,transform:l};k=e.createElement(ge,{onResize:w},e.createElement("span",{className:`${p}-string`,ref:j,style:i},v))}else k=e.createElement("span",{className:`${p}-string`,style:{opacity:0},ref:j},v);return U(e.createElement("span",Object.assign({},I,{style:Object.assign(Object.assign(Object.assign(Object.assign({},re),Q),m?.style),S),className:oe,ref:F}),k))}),X=t=>{const{size:r,shape:a}=e.useContext(H),o=e.useMemo(()=>({size:t.size||r,shape:t.shape||a}),[t.size,t.shape,r,a]);return e.createElement(H.Provider,{value:o},t.children)},ye=t=>{var r,a,o,n;const{getPrefixCls:d,direction:y}=e.useContext(q),{prefixCls:u,className:x,rootClassName:z,style:S,maxCount:M,maxStyle:G,size:v,shape:N,maxPopoverPlacement:h,maxPopoverTrigger:b,children:I,max:s}=t,C=d("avatar",u),f=`${C}-group`,O=K(C),[E,R,$]=D(C,O),j=T(f,{[`${f}-rtl`]:y==="rtl"},$,O,x,z,R),F=pe(I).map((g,w)=>ce(g,{key:`avatar-key-${w}`})),P=s?.count||M,m=F.length;if(P&&P<m){const g=F.slice(0,P),w=F.slice(P,m),B=s?.style||G,c=((r=s?.popover)===null||r===void 0?void 0:r.trigger)||b||"hover",_=((a=s?.popover)===null||a===void 0?void 0:a.placement)||h||"top",A=Object.assign(Object.assign({content:w},s?.popover),{classNames:{root:T(`${f}-popover`,(n=(o=s?.popover)===null||o===void 0?void 0:o.classNames)===null||n===void 0?void 0:n.root)},placement:_,trigger:c});return g.push(e.createElement(ve,Object.assign({key:"avatar-popover-key",destroyOnHidden:!0},A),e.createElement(J,{style:B},`+${m-P}`))),E(e.createElement(X,{shape:N,size:v},e.createElement("div",{className:j,style:S},g)))}return E(e.createElement(X,{shape:N,size:v},e.createElement("div",{className:j,style:S},F)))},xe=J;xe.Group=ye;export{xe as A};

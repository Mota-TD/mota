import{r as a,a as u,b as O,j as s,S as D}from"./index-jJjkrASA.js";import{p as F,i as E,a as B,m as U}from"./api-DUmAbDc_.js";import{T as G}from"./index-CnGp7M1w.js";import{R as g,C as l}from"./row-DbvWXo5m.js";import{C as n}from"./index-CiIGZjGq.js";import{R as J,a as K}from"./ProjectOutlined-COo3l7oN.js";import{S as x}from"./index-XJKxwp2H.js";import{R as _}from"./BugOutlined-CKjc4xeY.js";import{R as I}from"./ClockCircleOutlined-CiuAMI-C.js";import{R as N}from"./CheckCircleOutlined-CPk3538Q.js";import{L as m}from"./index-BVlP_4fx.js";import{T as Q}from"./index-C-XfQ0lz.js";import{P as W}from"./progress-BfLFEfyG.js";import{R as X}from"./CalendarOutlined-Cxn5QWrl.js";import{A as Y}from"./index-CzYeSCDM.js";import{I as v}from"./compact-item-CfP0ZfjF.js";import{R as C}from"./SyncOutlined-U0XDYDsF.js";import{R as A}from"./FileTextOutlined-Ts-3bQU2.js";import{R as Z}from"./TeamOutlined-CpiuOpeO.js";import"./EditOutlined-H6Ny8KCv.js";import"./getAllowClear-DijkFjz0.js";import"./CloseCircleFilled-DzUWwAnM.js";import"./styleChecker-apvlJGDR.js";import"./TextArea-D2UEp3z5.js";import"./CheckOutlined-CH83bvZX.js";import"./index-F9YRoaSd.js";import"./Skeleton-CpdpnCda.js";import"./index-KYPfHnUh.js";import"./CloseOutlined-JFFLTca6.js";import"./EllipsisOutlined-Bct-hJoY.js";import"./PlusOutlined-Bh2Mv01n.js";import"./extendsObject-78o_rR5W.js";import"./index-DDqd5aTF.js";import"./DownOutlined-CN1mv8sD.js";import"./PurePanel-BjAOE1jZ.js";import"./move-DCQK6w6D.js";import"./SearchOutlined-OiCr0NYv.js";import"./Pagination-4QOE6sQE.js";import"./LeftOutlined-DSxe2Naa.js";import"./RightOutlined-CFLGXWAw.js";import"./useClosable-Dcdur4ya.js";import"./CheckCircleFilled-C1tkfSYQ.js";import"./index-D31JVHEt.js";var ss={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"}}]},name:"file-add",theme:"outlined"},es=function(r,i){return a.createElement(v,u({},r,{ref:i,icon:ss}))},ts=a.forwardRef(es),cs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"},as=function(r,i){return a.createElement(v,u({},r,{ref:i,icon:cs}))},is=a.forwardRef(as),rs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},os=function(r,i){return a.createElement(v,u({},r,{ref:i,icon:rs}))},ns=a.forwardRef(os),ls={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"},ms=function(r,i){return a.createElement(v,u({},r,{ref:i,icon:ls}))},ds=a.forwardRef(ms),js={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"},us=function(r,i){return a.createElement(v,u({},r,{ref:i,icon:js}))},vs=a.forwardRef(us);const hs="_dashboard_mm0jv_1",ps="_loading_mm0jv_9",xs="_header_mm0jv_23",_s="_statsRow_mm0jv_45",fs="_statCard_mm0jv_53",gs="_statIcon_mm0jv_91",Is="_blue_mm0jv_111",Ns="_purple_mm0jv_121",Cs="_orange_mm0jv_131",As="_green_mm0jv_141",ys="_statInfo_mm0jv_151",ks="_listCard_mm0jv_185",Rs="_issueItem_mm0jv_267",bs="_issueContent_mm0jv_275",$s="_issueHeader_mm0jv_283",qs="_priorityDot_mm0jv_297",ws="_issueTitle_mm0jv_311",Ls="_issueMeta_mm0jv_329",Ss="_projectItem_mm0jv_343",Ms="_projectContent_mm0jv_351",Ts="_projectAvatar_mm0jv_365",Ps="_projectInfo_mm0jv_391",Vs="_projectName_mm0jv_401",zs="_projectDesc_mm0jv_417",Hs="_projectProgress_mm0jv_435",Os="_activityCard_mm0jv_447",Ds="_activityItem_mm0jv_505",Fs="_activityMeta_mm0jv_523",Es="_activityTime_mm0jv_535",Bs="_metricsCard_mm0jv_551",Us="_metricsContent_mm0jv_591",Gs="_metricItem_mm0jv_603",Js="_metricLabel_mm0jv_615",Ks="_metricValue_mm0jv_641",Qs="_quickActionsCard_mm0jv_655",Ws="_quickActions_mm0jv_655",Xs="_quickAction_mm0jv_655",Ys="_quickActionIcon_mm0jv_749",Zs="_pink_mm0jv_809",se="_teal_mm0jv_819",ee="_quickActionLabel_mm0jv_829",e={dashboard:hs,loading:ps,header:xs,statsRow:_s,statCard:fs,statIcon:gs,blue:Is,purple:Ns,orange:Cs,green:As,statInfo:ys,listCard:ks,issueItem:Rs,issueContent:bs,issueHeader:$s,priorityDot:qs,issueTitle:ws,issueMeta:Ls,projectItem:Ss,projectContent:Ms,projectAvatar:Ts,projectInfo:Ps,projectName:Vs,projectDesc:zs,projectProgress:Hs,activityCard:Os,activityItem:Ds,activityMeta:Fs,activityTime:Es,metricsCard:Bs,metricsContent:Us,metricItem:Gs,metricLabel:Js,metricValue:Ks,quickActionsCard:Qs,quickActions:Ws,quickAction:Xs,quickActionIcon:Ys,pink:Zs,teal:se,quickActionLabel:ee},{Title:te,Text:d}=G,Je=()=>{const c=O(),[r,i]=a.useState(!0),[h,y]=a.useState({totalProjects:0,totalIssues:0,completedIssues:0,inProgressIssues:0}),[k,R]=a.useState([]),[b,$]=a.useState([]),[q,w]=a.useState([]),[o,L]=a.useState(null);a.useEffect(()=>{S()},[]);const S=async()=>{i(!0);try{const j=(await F.getProjects()).data.list||[];R(j.slice(0,5));const p=(await E.getIssues()).data.list||[];$(p.slice(0,5)),y({totalProjects:j.length,totalIssues:p.length,completedIssues:p.filter(f=>f.status==="done").length,inProgressIssues:p.filter(f=>f.status==="in_progress").length});const z=await B.getActivities();w(z.data.slice(0,8));const H=await U.getMetrics();L(H.data)}catch(t){console.error("Failed to load dashboard data:",t)}finally{i(!1)}},M=t=>({open:"blue",in_progress:"orange",done:"green",closed:"default"})[t]||"default",T=t=>({open:"待处理",in_progress:"进行中",done:"已完成",closed:"已关闭"})[t]||t,P=t=>({highest:"#ff4d4f",high:"#fa8c16",medium:"#1677ff",low:"#52c41a",lowest:"#8c8c8c"})[t]||"#8c8c8c",V=t=>({issue_created:s.jsx(_,{}),issue_updated:s.jsx(_,{}),issue_completed:s.jsx(N,{}),comment_added:s.jsx(A,{}),member_joined:s.jsx(Z,{})})[t]||s.jsx(A,{});return r?s.jsx("div",{className:e.loading,children:s.jsx(D,{size:"large"})}):s.jsxs("div",{className:e.dashboard,children:[s.jsxs("div",{className:e.header,children:[s.jsx(te,{level:4,children:"工作台"}),s.jsx(d,{type:"secondary",children:"欢迎回来，这是您的工作概览"})]}),s.jsxs(g,{gutter:[20,20],className:e.statsRow,children:[s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsxs(n,{className:e.statCard,onClick:()=>c("/projects"),children:[s.jsx("div",{className:`${e.statIcon} ${e.blue}`,children:s.jsx(J,{})}),s.jsx("div",{className:e.statInfo,children:s.jsx(x,{title:"项目总数",value:h.totalProjects,valueStyle:{color:"#2b7de9"}})})]})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsxs(n,{className:e.statCard,onClick:()=>c("/issues"),children:[s.jsx("div",{className:`${e.statIcon} ${e.purple}`,children:s.jsx(_,{})}),s.jsx("div",{className:e.statInfo,children:s.jsx(x,{title:"事项总数",value:h.totalIssues,valueStyle:{color:"#722ed1"}})})]})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsxs(n,{className:e.statCard,onClick:()=>c("/issues?status=in_progress"),children:[s.jsx("div",{className:`${e.statIcon} ${e.orange}`,children:s.jsx(I,{})}),s.jsx("div",{className:e.statInfo,children:s.jsx(x,{title:"进行中",value:h.inProgressIssues,valueStyle:{color:"#fa8c16"}})})]})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsxs(n,{className:e.statCard,onClick:()=>c("/issues?status=done"),children:[s.jsx("div",{className:`${e.statIcon} ${e.green}`,children:s.jsx(N,{})}),s.jsx("div",{className:e.statInfo,children:s.jsx(x,{title:"已完成",value:h.completedIssues,valueStyle:{color:"#52c41a"}})})]})})]}),s.jsxs(g,{gutter:[20,20],children:[s.jsx(l,{xs:24,lg:12,children:s.jsx(n,{title:"我的待办",extra:s.jsx("a",{onClick:()=>c("/issues"),children:"查看全部"}),className:e.listCard,children:s.jsx(m,{dataSource:b,renderItem:t=>s.jsx(m.Item,{className:e.issueItem,onClick:()=>c(`/issues/${t.id}`),children:s.jsxs("div",{className:e.issueContent,children:[s.jsxs("div",{className:e.issueHeader,children:[s.jsx("span",{className:e.priorityDot,style:{backgroundColor:P(t.priority)}}),s.jsx(d,{strong:!0,className:e.issueTitle,children:t.title})]}),s.jsxs("div",{className:e.issueMeta,children:[s.jsx(Q,{color:M(t.status),children:T(t.status)}),s.jsx(d,{type:"secondary",style:{fontSize:12},children:t.key})]})]})}),locale:{emptyText:"暂无事项"}})})}),s.jsx(l,{xs:24,lg:12,children:s.jsx(n,{title:"最近项目",extra:s.jsx("a",{onClick:()=>c("/projects"),children:"查看全部"}),className:e.listCard,children:s.jsx(m,{dataSource:k,renderItem:t=>s.jsx(m.Item,{className:e.projectItem,onClick:()=>c(`/projects/${t.id}`),children:s.jsxs("div",{className:e.projectContent,children:[s.jsx("div",{className:e.projectAvatar,style:{backgroundColor:t.color||"#2b7de9"},children:t.name.charAt(0)}),s.jsxs("div",{className:e.projectInfo,children:[s.jsx("span",{className:e.projectName,children:t.name}),s.jsx("span",{className:e.projectDesc,children:t.description||"暂无描述"})]}),s.jsx("div",{className:e.projectProgress,children:s.jsx(W,{percent:t.progress||0,size:"small",strokeColor:"#2b7de9",showInfo:!0})})]})}),locale:{emptyText:"暂无项目"}})})})]}),s.jsxs(g,{gutter:[20,20],style:{marginTop:20},children:[s.jsx(l,{xs:24,lg:16,children:s.jsx(n,{title:"最近动态",className:e.activityCard,children:s.jsx(m,{dataSource:q,renderItem:t=>s.jsx(m.Item,{className:e.activityItem,children:s.jsx(m.Item.Meta,{avatar:s.jsx(Y,{style:{backgroundColor:"#2b7de9"},children:V(t.type)}),title:s.jsxs("span",{children:[s.jsx(d,{strong:!0,children:t.user?.name||"用户"}),s.jsxs(d,{type:"secondary",children:[" ",t.action]})]}),description:s.jsxs("div",{className:e.activityMeta,children:[s.jsx(d,{type:"secondary",children:t.target}),s.jsxs(d,{type:"secondary",className:e.activityTime,children:[s.jsx(X,{})," ",t.time]})]})})}),locale:{emptyText:"暂无动态"}})})}),s.jsx(l,{xs:24,lg:8,children:s.jsx(n,{title:"效能概览",className:e.metricsCard,children:o&&s.jsxs("div",{className:e.metricsContent,children:[s.jsxs("div",{className:e.metricItem,children:[s.jsxs("div",{className:e.metricLabel,children:[s.jsx(ds,{})," 部署频率"]}),s.jsxs("div",{className:e.metricValue,children:[o.dora?.deploymentFrequency?.value||0," ",o.dora?.deploymentFrequency?.unit||"次/周"]})]}),s.jsxs("div",{className:e.metricItem,children:[s.jsxs("div",{className:e.metricLabel,children:[s.jsx(I,{})," 变更前置时间"]}),s.jsxs("div",{className:e.metricValue,children:[o.dora?.leadTime?.value||0," ",o.dora?.leadTime?.unit||"天"]})]}),s.jsxs("div",{className:e.metricItem,children:[s.jsxs("div",{className:e.metricLabel,children:[s.jsx(_,{})," 变更失败率"]}),s.jsxs("div",{className:e.metricValue,children:[o.dora?.changeFailureRate?.value||0,o.dora?.changeFailureRate?.unit||"%"]})]}),s.jsxs("div",{className:e.metricItem,children:[s.jsxs("div",{className:e.metricLabel,children:[s.jsx(C,{})," 平均恢复时间"]}),s.jsxs("div",{className:e.metricValue,children:[o.dora?.mttr?.value||0," ",o.dora?.mttr?.unit||"小时"]})]})]})})})]}),s.jsx(n,{title:"快捷入口",className:e.quickActionsCard,children:s.jsxs("div",{className:e.quickActions,children:[s.jsxs("div",{className:e.quickAction,onClick:()=>c("/issues/new"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.blue}`,children:s.jsx(ns,{})}),s.jsx("span",{className:e.quickActionLabel,children:"创建事项"})]}),s.jsxs("div",{className:e.quickAction,onClick:()=>c("/projects/new"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.green}`,children:s.jsx(is,{})}),s.jsx("span",{className:e.quickActionLabel,children:"新建项目"})]}),s.jsxs("div",{className:e.quickAction,onClick:()=>c("/iterations/new"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.orange}`,children:s.jsx(C,{})}),s.jsx("span",{className:e.quickActionLabel,children:"新建迭代"})]}),s.jsxs("div",{className:e.quickAction,onClick:()=>c("/test-cases"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.purple}`,children:s.jsx(K,{})}),s.jsx("span",{className:e.quickActionLabel,children:"测试用例"})]}),s.jsxs("div",{className:e.quickAction,onClick:()=>c("/wiki/new"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.pink}`,children:s.jsx(ts,{})}),s.jsx("span",{className:e.quickActionLabel,children:"新建文档"})]}),s.jsxs("div",{className:e.quickAction,onClick:()=>c("/members"),children:[s.jsx("div",{className:`${e.quickActionIcon} ${e.teal}`,children:s.jsx(vs,{})}),s.jsx("span",{className:e.quickActionLabel,children:"邀请成员"})]})]})})]})};export{Je as default};

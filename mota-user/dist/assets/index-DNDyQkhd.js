import{r as a,j as e}from"./index-jJjkrASA.js";import{u as T}from"./api-DUmAbDc_.js";import{F as i}from"./index-CNgAusFm.js";import{S as j}from"./index-DEZvTLAg.js";import{A as $}from"./index-CzYeSCDM.js";import{R as b}from"./UserOutlined-eSGHSk0-.js";import{T as E}from"./index-C-XfQ0lz.js";import{D as L}from"./index-BUg6PNCH.js";import{B as v}from"./button-Bv8EyRxh.js";import{R as O}from"./MoreOutlined-CjOKr4kg.js";import{R as A}from"./EditOutlined-H6Ny8KCv.js";import{R as D}from"./DeleteOutlined-KwwWlgLe.js";import{P as N}from"./index-CsnD-CV0.js";import{C as q}from"./index-CiIGZjGq.js";import{I as p}from"./index-DR1THxsW.js";import{R as z}from"./SearchOutlined-OiCr0NYv.js";import{R as P}from"./PlusOutlined-Bh2Mv01n.js";import{F as B}from"./Table-D_d-WrwC.js";import{M as V}from"./index--XrJVTfB.js";import{R as J}from"./MailOutlined-oI0r4Pgz.js";import{S as K}from"./index-DDqd5aTF.js";import{s as u}from"./index-C54hh6U9.js";import"./getAllowClear-DijkFjz0.js";import"./compact-item-CfP0ZfjF.js";import"./CloseCircleFilled-DzUWwAnM.js";import"./useForm-PTvZdMqb.js";import"./row-DbvWXo5m.js";import"./index-F9YRoaSd.js";import"./CheckCircleFilled-C1tkfSYQ.js";import"./ExclamationCircleFilled-CjD5Kf6C.js";import"./index-D31JVHEt.js";import"./useClosable-Dcdur4ya.js";import"./CloseOutlined-JFFLTca6.js";import"./extendsObject-78o_rR5W.js";import"./LeftOutlined-DSxe2Naa.js";import"./RightOutlined-CFLGXWAw.js";import"./EllipsisOutlined-Bct-hJoY.js";import"./PurePanel-BjAOE1jZ.js";import"./move-DCQK6w6D.js";import"./ActionButton-BlIwnF7n.js";import"./Skeleton-CpdpnCda.js";import"./index-KYPfHnUh.js";import"./Input-BYqifNCC.js";import"./TextArea-D2UEp3z5.js";import"./styleChecker-apvlJGDR.js";import"./DownOutlined-CN1mv8sD.js";import"./index-CCdK-d4Q.js";import"./index-DDCwCr0k.js";import"./index-x8kxzmt0.js";import"./useBubbleLock-DgSu3aet.js";import"./index-BRkQ33iO.js";import"./Pagination-4QOE6sQE.js";import"./fade-5De2vm1n.js";import"./CheckOutlined-CH83bvZX.js";const Q="_container_1xp6h_1",U="_header_1xp6h_13",W="_title_1xp6h_27",G="_count_1xp6h_51",m={container:Q,header:U,title:W,count:G},f=[{value:"admin",label:"管理员",color:"red"},{value:"pm",label:"项目经理",color:"orange"},{value:"developer",label:"开发者",color:"blue"},{value:"tester",label:"测试人员",color:"green"},{value:"member",label:"成员",color:"default"}],He=()=>{const[g,x]=a.useState(!0),[o,l]=a.useState([]),[c,y]=a.useState(""),[w,n]=a.useState(!1),[d,h]=a.useState(null),[s]=i.useForm();a.useEffect(()=>{I()},[]);const I=async()=>{x(!0);try{const r=await T.getUsers();l(r.data)}catch(r){console.error("Failed to load members:",r)}finally{x(!1)}},R=r=>f.find(t=>t.value===r)||{label:r,color:"default"},S=o.filter(r=>r.name.toLowerCase().includes(c.toLowerCase())||r.email.toLowerCase().includes(c.toLowerCase())),_=()=>{h(null),s.resetFields(),n(!0)},C=r=>{h(r),s.setFieldsValue(r),n(!0)},M=r=>{l(o.filter(t=>t.id!==r.id)),u.success("成员已移除")},F=async()=>{try{const r=await s.validateFields();if(d)l(o.map(t=>t.id===d.id?{...t,...r}:t)),u.success("成员信息已更新");else{const t={id:o.length+1,name:r.name,email:r.email,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${Date.now()}`,role:r.role};l([...o,t]),u.success("成员已添加")}n(!1),s.resetFields()}catch(r){console.error("Validation failed:",r)}},k=[{title:"成员",key:"member",render:(r,t)=>e.jsxs(j,{children:[e.jsx($,{src:t.avatar,icon:e.jsx(b,{})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:t.name}),e.jsx("div",{style:{fontSize:12,color:"#999"},children:t.email})]})]})},{title:"角色",dataIndex:"role",key:"role",render:r=>{const t=R(r);return e.jsx(E,{color:t.color,children:t.label})},filters:f.map(r=>({text:r.label,value:r.value})),onFilter:(r,t)=>t.role===r},{title:"操作",key:"action",width:100,render:(r,t)=>e.jsx(L,{menu:{items:[{key:"edit",label:"编辑",icon:e.jsx(A,{}),onClick:()=>C(t)},{key:"delete",label:e.jsx(N,{title:"确定要移除该成员吗？",onConfirm:()=>M(t),okText:"确定",cancelText:"取消",children:e.jsx("span",{children:"移除"})}),icon:e.jsx(D,{}),danger:!0}]},children:e.jsx(v,{type:"text",icon:e.jsx(O,{})})})}];return e.jsxs("div",{className:m.container,children:[e.jsxs(q,{children:[e.jsxs("div",{className:m.header,children:[e.jsxs("div",{className:m.title,children:[e.jsx("h2",{children:"成员管理"}),e.jsxs("span",{className:m.count,children:["共 ",o.length," 名成员"]})]}),e.jsxs(j,{children:[e.jsx(p,{placeholder:"搜索成员...",prefix:e.jsx(z,{}),value:c,onChange:r=>y(r.target.value),style:{width:200},allowClear:!0}),e.jsx(v,{type:"primary",icon:e.jsx(P,{}),onClick:_,children:"添加成员"})]})]}),e.jsx(B,{columns:k,dataSource:S,rowKey:"id",loading:g,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:r=>`共 ${r} 条`}})]}),e.jsx(V,{title:d?"编辑成员":"添加成员",open:w,onOk:F,onCancel:()=>{n(!1),s.resetFields()},children:e.jsxs(i,{form:s,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入姓名"}],children:e.jsx(p,{prefix:e.jsx(b,{}),placeholder:"请输入姓名"})}),e.jsx(i.Item,{name:"email",label:"邮箱",rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入有效的邮箱地址"}],children:e.jsx(p,{prefix:e.jsx(J,{}),placeholder:"请输入邮箱"})}),e.jsx(i.Item,{name:"role",label:"角色",rules:[{required:!0,message:"请选择角色"}],children:e.jsx(K,{placeholder:"请选择角色",options:f})})]})})]})};export{He as default};

# Mota Admin ç¬¬ä¸€é˜¶æ®µå¼€å‘å®Œæˆæ€»ç»“

> **å®Œæˆæ—¥æœŸ**: 2026-01-30  
> **ç‰ˆæœ¬**: v1.1 - ç¬¬ä¸€é˜¶æ®µæ ¸å¿ƒåŠŸèƒ½å®Œæˆ

---

## âœ… æœ¬æ¬¡å®Œæˆçš„å·¥ä½œ

### 1. TypeScriptç±»å‹å®šä¹‰ä½“ç³»

åˆ›å»ºäº†å®Œæ•´çš„ç±»å‹å®šä¹‰ç³»ç»Ÿï¼Œä½äº [`src/types/`](../src/types/) ç›®å½•ï¼š

#### é€šç”¨ç±»å‹ ([`common.ts`](../src/types/common.ts))
- `ApiResponse<T>` - ç»Ÿä¸€çš„APIå“åº”æ ¼å¼
- `PageParams` - åˆ†é¡µè¯·æ±‚å‚æ•°
- `PageData<T>` - åˆ†é¡µå“åº”æ•°æ®
- `ErrorResponse` - é”™è¯¯å“åº”æ ¼å¼
- `StatusEnum` - çŠ¶æ€æšä¸¾
- `RoleEnum` - è§’è‰²æšä¸¾

#### è®¤è¯ç±»å‹ ([`auth.ts`](../src/types/auth.ts))
- `LoginParams` - ç™»å½•è¯·æ±‚å‚æ•°
- `LoginResult` - ç™»å½•å“åº”æ•°æ®
- `UserInfo` - ç”¨æˆ·ä¿¡æ¯
- `RefreshTokenParams` - Tokenåˆ·æ–°å‚æ•°
- `ChangePasswordParams` - ä¿®æ”¹å¯†ç å‚æ•°

#### ç§Ÿæˆ·ç±»å‹ ([`tenant.ts`](../src/types/tenant.ts))
- `Tenant` - ç§Ÿæˆ·ä¿¡æ¯
- `CreateTenantParams` - åˆ›å»ºç§Ÿæˆ·å‚æ•°
- `UpdateTenantParams` - æ›´æ–°ç§Ÿæˆ·å‚æ•°
- `Package` - å¥—é¤ä¿¡æ¯
- `Order` - è®¢å•ä¿¡æ¯
- `TenantStats` - ç§Ÿæˆ·ç»Ÿè®¡ä¿¡æ¯

#### ç”¨æˆ·ç±»å‹ ([`user.ts`](../src/types/user.ts))
- `User` - ç”¨æˆ·ä¿¡æ¯
- `CreateUserParams` - åˆ›å»ºç”¨æˆ·å‚æ•°
- `UpdateUserParams` - æ›´æ–°ç”¨æˆ·å‚æ•°
- `Feedback` - ç”¨æˆ·åé¦ˆ
- `UserStats` - ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯

### 2. APIæœåŠ¡å±‚å®ç°

åˆ›å»ºäº†å®Œæ•´çš„APIæœåŠ¡å±‚ï¼Œä½äº [`src/services/`](../src/services/) ç›®å½•ï¼š

#### è®¤è¯æœåŠ¡ ([`auth.ts`](../src/services/auth.ts))
```typescript
- login()           // ç”¨æˆ·ç™»å½•
- logout()          // ç”¨æˆ·ç™»å‡º
- getCurrentUser()  // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- refreshToken()    // åˆ·æ–°Token
- changePassword()  // ä¿®æ”¹å¯†ç 
- validateToken()   // éªŒè¯Token
```

#### ç§Ÿæˆ·æœåŠ¡ ([`tenant.ts`](../src/services/tenant.ts))
```typescript
- getTenantList()      // è·å–ç§Ÿæˆ·åˆ—è¡¨
- getTenantDetail()    // è·å–ç§Ÿæˆ·è¯¦æƒ…
- createTenant()       // åˆ›å»ºç§Ÿæˆ·
- updateTenant()       // æ›´æ–°ç§Ÿæˆ·
- deleteTenant()       // åˆ é™¤ç§Ÿæˆ·
- toggleTenantStatus() // å¯ç”¨/ç¦ç”¨ç§Ÿæˆ·
- getPackageList()     // è·å–å¥—é¤åˆ—è¡¨
- getOrderList()       // è·å–è®¢å•åˆ—è¡¨
- getTenantStats()     // è·å–ç§Ÿæˆ·ç»Ÿè®¡
- renewTenant()        // ç»­è´¹ç§Ÿæˆ·
```

#### ç”¨æˆ·æœåŠ¡ ([`user.ts`](../src/services/user.ts))
```typescript
- getUserList()        // è·å–ç”¨æˆ·åˆ—è¡¨
- getUserDetail()      // è·å–ç”¨æˆ·è¯¦æƒ…
- createUser()         // åˆ›å»ºç”¨æˆ·
- updateUser()         // æ›´æ–°ç”¨æˆ·
- deleteUser()         // åˆ é™¤ç”¨æˆ·
- toggleUserStatus()   // å¯ç”¨/ç¦ç”¨ç”¨æˆ·
- resetUserPassword()  // é‡ç½®å¯†ç 
- getFeedbackList()    // è·å–åé¦ˆåˆ—è¡¨
- getFeedbackDetail()  // è·å–åé¦ˆè¯¦æƒ…
- respondFeedback()    // å›å¤åé¦ˆ
- getUserStats()       // è·å–ç”¨æˆ·ç»Ÿè®¡
```

### 3. Tokenç®¡ç†ç³»ç»Ÿ

#### Tokenå·¥å…· ([`utils/token.ts`](../src/utils/token.ts))
```typescript
- setToken()         // ä¿å­˜Token
- getToken()         // è·å–Token
- removeToken()      // ç§»é™¤Token
- setRefreshToken()  // ä¿å­˜RefreshToken
- getRefreshToken()  // è·å–RefreshToken
- setTokenExpire()   // ä¿å­˜è¿‡æœŸæ—¶é—´
- isTokenExpired()   // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
- saveLoginInfo()    // ä¿å­˜å®Œæ•´ç™»å½•ä¿¡æ¯
- clearLoginInfo()   // æ¸…é™¤ç™»å½•ä¿¡æ¯
```

#### Tokenè‡ªåŠ¨åˆ·æ–° ([`utils/refreshToken.ts`](../src/utils/refreshToken.ts))
```typescript
- tryRefreshToken()          // å°è¯•åˆ·æ–°Token
- checkAndRefreshToken()     // æ£€æŸ¥å¹¶åˆ·æ–°Token
- startTokenRefreshTimer()   // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨
- stopTokenRefreshTimer()    // åœæ­¢è‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨
```

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… Tokenè¿‡æœŸå‰5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
- âœ… è¯·æ±‚æ’é˜Ÿæœºåˆ¶ï¼Œé¿å…å¹¶å‘åˆ·æ–°
- âœ… æ¯åˆ†é’Ÿè‡ªåŠ¨æ£€æŸ¥TokençŠ¶æ€
- âœ… ç™»å½•/ç™»å‡ºæ—¶è‡ªåŠ¨ç®¡ç†å®šæ—¶å™¨

### 4. è®¤è¯æˆæƒå®Œæ•´æµç¨‹

#### ç™»å½•æµç¨‹æ”¹é€  ([`pages/user/login/index.tsx`](../src/pages/user/login/index.tsx))
```typescript
1. ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
2. è°ƒç”¨ login() API
3. ä¿å­˜ tokenã€refreshTokenã€expiresIn
4. è·å–ç”¨æˆ·ä¿¡æ¯
5. è·³è½¬åˆ°é¦–é¡µæˆ–redirectæŒ‡å®šé¡µé¢
```

#### åº”ç”¨åˆå§‹åŒ– ([`app.tsx`](../src/app.tsx))
```typescript
1. æ£€æŸ¥æ˜¯å¦æœ‰Token
2. Tokenæœ‰æ•ˆæ—¶è·å–ç”¨æˆ·ä¿¡æ¯
3. å¯åŠ¨Tokenè‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨
4. è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ Token
5. å“åº”æ‹¦æˆªå™¨å¤„ç†401é”™è¯¯
```

#### ç™»å‡ºæµç¨‹ ([`components/RightContent/AvatarDropdown.tsx`](../src/components/RightContent/AvatarDropdown.tsx))
```typescript
1. è°ƒç”¨ logout() API
2. æ¸…é™¤æœ¬åœ°Tokenä¿¡æ¯
3. åœæ­¢Tokenåˆ·æ–°å®šæ—¶å™¨
4. è·³è½¬åˆ°ç™»å½•é¡µ
```

### 5. ç»Ÿä¸€é”™è¯¯å¤„ç†

#### é”™è¯¯å¤„ç†é…ç½® ([`requestErrorConfig.ts`](../src/requestErrorConfig.ts))

**HTTPçŠ¶æ€ç å¤„ç†**:
- `401` - è‡ªåŠ¨æ¸…é™¤Tokenå¹¶è·³è½¬ç™»å½•é¡µ
- `403` - æ˜¾ç¤ºæƒé™ä¸è¶³æç¤º
- `404` - æ˜¾ç¤ºèµ„æºä¸å­˜åœ¨æç¤º
- `500/502/503` - æ˜¾ç¤ºæœåŠ¡å™¨é”™è¯¯æç¤º

**é”™è¯¯æ˜¾ç¤ºç±»å‹**:
- `SILENT` - é™é»˜å¤„ç†
- `WARN_MESSAGE` - è­¦å‘Šæ¶ˆæ¯
- `ERROR_MESSAGE` - é”™è¯¯æ¶ˆæ¯
- `NOTIFICATION` - é€šçŸ¥å¼¹çª—
- `REDIRECT` - é‡å®šå‘åˆ°ç™»å½•é¡µ

### 6. é€šç”¨åŸºç¡€ç»„ä»¶

#### é¡µé¢åŠ è½½ç»„ä»¶ ([`components/PageLoading/index.tsx`](../src/components/PageLoading/index.tsx))
```typescript
<PageLoading tip="åŠ è½½ä¸­..." />
```

#### é”™è¯¯è¾¹ç•Œç»„ä»¶ ([`components/ErrorBoundary/index.tsx`](../src/components/ErrorBoundary/index.tsx))
```typescript
<ErrorBoundary>
  <YourComponent />
</ErrorBoundary>
```

**åŠŸèƒ½ç‰¹æ€§**:
- æ•è·ç»„ä»¶æ¸²æŸ“é”™è¯¯
- æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
- æä¾›åˆ·æ–°é¡µé¢åŠŸèƒ½

---

## ğŸ“Š é¡¹ç›®ç»“æ„æ›´æ–°

```
mota-admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/              # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ common.ts       # é€šç”¨ç±»å‹
â”‚   â”‚   â”œâ”€â”€ auth.ts         # è®¤è¯ç±»å‹
â”‚   â”‚   â”œâ”€â”€ tenant.ts       # ç§Ÿæˆ·ç±»å‹
â”‚   â”‚   â”œâ”€â”€ user.ts         # ç”¨æˆ·ç±»å‹
â”‚   â”‚   â””â”€â”€ index.ts        # ç±»å‹å¯¼å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ services/           # APIæœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ auth.ts         # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ tenant.ts       # ç§Ÿæˆ·æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ user.ts         # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â””â”€â”€ index.ts        # æœåŠ¡å¯¼å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ token.ts        # Tokenç®¡ç†
â”‚   â”‚   â””â”€â”€ refreshToken.ts # Tokenè‡ªåŠ¨åˆ·æ–°
â”‚   â”‚
â”‚   â”œâ”€â”€ components/         # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PageLoading/    # é¡µé¢åŠ è½½
â”‚   â”‚   â”œâ”€â”€ ErrorBoundary/  # é”™è¯¯è¾¹ç•Œ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â””â”€â”€ user/login/     # ç™»å½•é¡µé¢ï¼ˆå·²å®Œå–„ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ app.tsx             # åº”ç”¨é…ç½®ï¼ˆå·²æ›´æ–°ï¼‰
â”‚   â””â”€â”€ requestErrorConfig.ts # é”™è¯¯å¤„ç†ï¼ˆå·²ä¼˜åŒ–ï¼‰
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ 01-é¡¹ç›®åˆå§‹åŒ–æ€»ç»“.md
    â””â”€â”€ 02-ç¬¬ä¸€é˜¶æ®µå¼€å‘å®Œæˆæ€»ç»“.md
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### 1. ç±»å‹å®‰å…¨
- âœ… å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- âœ… ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- âœ… æ™ºèƒ½ä»£ç æç¤º
- âœ… å‡å°‘è¿è¡Œæ—¶é”™è¯¯

### 2. è®¤è¯æˆæƒ
- âœ… JWT Tokenè®¤è¯
- âœ… Tokenè‡ªåŠ¨åˆ·æ–°
- âœ… ç™»å½•/ç™»å‡ºå®Œæ•´æµç¨‹
- âœ… 401è‡ªåŠ¨è·³è½¬ç™»å½•
- âœ… Tokenè¿‡æœŸè‡ªåŠ¨å¤„ç†

### 3. APIæœåŠ¡
- âœ… RESTful APIè®¾è®¡
- âœ… ç»Ÿä¸€çš„è¯·æ±‚/å“åº”æ ¼å¼
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… è‡ªåŠ¨æ·»åŠ Token
- âœ… ç›´è¿API Gateway

### 4. ç”¨æˆ·ä½“éªŒ
- âœ… å‹å¥½çš„é”™è¯¯æç¤º
- âœ… åŠ è½½çŠ¶æ€å±•ç¤º
- âœ… é”™è¯¯è¾¹ç•Œä¿æŠ¤
- âœ… è‡ªåŠ¨Tokenåˆ·æ–°ï¼ˆæ— æ„ŸçŸ¥ï¼‰

---

## ğŸ”§ æŠ€æœ¯äº®ç‚¹

### 1. Tokenç®¡ç†
```typescript
// è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- æå‰5åˆ†é’Ÿåˆ·æ–°Token
- è¯·æ±‚æ’é˜Ÿé¿å…å¹¶å‘
- å®šæ—¶å™¨è‡ªåŠ¨æ£€æŸ¥
- ç™»å½•/ç™»å‡ºè‡ªåŠ¨ç®¡ç†
```

### 2. é”™è¯¯å¤„ç†
```typescript
// å¤šå±‚æ¬¡é”™è¯¯å¤„ç†
- è¯·æ±‚æ‹¦æˆªå™¨
- å“åº”æ‹¦æˆªå™¨
- ç»Ÿä¸€é”™è¯¯å¤„ç†é…ç½®
- HTTPçŠ¶æ€ç å¤„ç†
- ä¸šåŠ¡é”™è¯¯ç å¤„ç†
```

### 3. ç±»å‹ç³»ç»Ÿ
```typescript
// å®Œæ•´çš„ç±»å‹å®šä¹‰
- APIè¯·æ±‚å‚æ•°ç±»å‹
- APIå“åº”æ•°æ®ç±»å‹
- ä¸šåŠ¡å®ä½“ç±»å‹
- æšä¸¾ç±»å‹
- å·¥å…·ç±»å‹
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### 1. ç™»å½•
```typescript
import { login } from '@/services/auth';
import { saveLoginInfo } from '@/utils/token';

const handleLogin = async (username: string, password: string) => {
  const response = await login({ username, password, type: 'account' });
  if (response.code === 0) {
    const { token, refreshToken, expiresIn } = response.data;
    saveLoginInfo(token, refreshToken, expiresIn);
    // è·³è½¬åˆ°é¦–é¡µ
  }
};
```

### 2. APIè°ƒç”¨
```typescript
import { getTenantList } from '@/services/tenant';
import type { PageParams } from '@/types';

const fetchTenants = async (params: PageParams) => {
  const response = await getTenantList(params);
  if (response.code === 0) {
    return response.data; // PageData<Tenant>
  }
};
```

### 3. Tokenç®¡ç†
```typescript
import { getToken, isTokenExpired, checkAndRefreshToken } from '@/utils';

// æ£€æŸ¥Token
const token = getToken();
const expired = isTokenExpired();

// è‡ªåŠ¨åˆ·æ–°Token
await checkAndRefreshToken();
```

---

## âš ï¸ å¾…å®ŒæˆåŠŸèƒ½

### ç¬¬äºŒé˜¶æ®µä»»åŠ¡ï¼ˆWeek 3-4ï¼‰
- [ ] å®Œå–„ç§Ÿæˆ·ç®¡ç†é¡µé¢åŠŸèƒ½
- [ ] å®Œå–„ç”¨æˆ·ç®¡ç†é¡µé¢åŠŸèƒ½
- [ ] å¼€å‘å†…å®¹ç®¡ç†æ¨¡å—
- [ ] å¯¹æ¥åç«¯APIï¼ˆéœ€è¦mota-tenant-serviceï¼‰
- [ ] æ·»åŠ æ•°æ®Mockæ”¯æŒ

### ç¬¬ä¸‰é˜¶æ®µä»»åŠ¡ï¼ˆWeek 5-6ï¼‰
- [ ] å¼€å‘AIç®¡ç†æ¨¡å—
- [ ] å¼€å‘ç³»ç»Ÿç®¡ç†æ¨¡å—
- [ ] å¼€å‘æ•°æ®åˆ†ææ¨¡å—
- [ ] é›†æˆEChartså›¾è¡¨ç»„ä»¶

### ç¬¬å››é˜¶æ®µä»»åŠ¡ï¼ˆWeek 7ï¼‰
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å®‰å…¨æµ‹è¯•
- [ ] éƒ¨ç½²ä¸Šçº¿

---

## ğŸ› å·²çŸ¥é—®é¢˜

### 1. APIå¯¹æ¥
- **çŠ¶æ€**: å¾…å¯¹æ¥
- **å½±å“**: æ‰€æœ‰APIè¯·æ±‚ç›®å‰æ— æ³•æ­£å¸¸å·¥ä½œ
- **è§£å†³**: éœ€è¦å¼€å‘mota-tenant-serviceåç«¯æœåŠ¡

### 2. Mockæ•°æ®
- **çŠ¶æ€**: æœªå®ç°
- **å½±å“**: å¼€å‘æœŸé—´æ— æ³•æŸ¥çœ‹å®é™…æ•°æ®æ•ˆæœ
- **è§£å†³**: å¯é€‰æ‹©æ·»åŠ Mockæ•°æ®æ”¯æŒ

### 3. æµ‹è¯•è¦†ç›–
- **çŠ¶æ€**: æœªå®ç°
- **å½±å“**: ä»£ç è´¨é‡æ— æ³•ä¿è¯
- **è§£å†³**: æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç¬¬ä¸€é˜¶æ®µåˆå§‹åŒ–æ€»ç»“](./01-é¡¹ç›®åˆå§‹åŒ–æ€»ç»“.md)
- [æ¶æ„æ–¹æ¡ˆ](../../plans/æ¶æ„æœ€ç»ˆæ–¹æ¡ˆ.md)
- [æŠ€æœ¯æ–¹æ¡ˆ](../../plans/mota-admin-æŠ€æœ¯æ–¹æ¡ˆ.md)
- [Ant Design Proæ–‡æ¡£](https://pro.ant.design/)
- [UmiJSæ–‡æ¡£](https://umijs.org/)
- [TypeScriptæ–‡æ¡£](https://www.typescriptlang.org/)

---

## ğŸ‰ é˜¶æ®µæ€»ç»“

ç¬¬ä¸€é˜¶æ®µæ ¸å¿ƒåŠŸèƒ½å¼€å‘å·²å®Œæˆï¼Œä¸»è¦å®ç°äº†ï¼š

1. âœ… **å®Œæ•´çš„ç±»å‹ç³»ç»Ÿ** - 4ä¸ªç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œè¦†ç›–æ‰€æœ‰ä¸šåŠ¡å®ä½“
2. âœ… **APIæœåŠ¡å±‚** - 3ä¸ªæœåŠ¡æ–‡ä»¶ï¼Œ30+ä¸ªAPIæ¥å£
3. âœ… **Tokenç®¡ç†** - å®Œæ•´çš„Tokenç”Ÿå‘½å‘¨æœŸç®¡ç†
4. âœ… **è‡ªåŠ¨åˆ·æ–°** - Tokenè¿‡æœŸå‰è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
5. âœ… **è®¤è¯æµç¨‹** - ç™»å½•/ç™»å‡ºå®Œæ•´æµç¨‹
6. âœ… **é”™è¯¯å¤„ç†** - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
7. âœ… **åŸºç¡€ç»„ä»¶** - åŠ è½½å’Œé”™è¯¯è¾¹ç•Œç»„ä»¶

**ä¸‹ä¸€æ­¥å·¥ä½œé‡ç‚¹**ï¼š
- å¼€å‘ç§Ÿæˆ·ç®¡ç†åŠŸèƒ½é¡µé¢
- å¼€å‘ç”¨æˆ·ç®¡ç†åŠŸèƒ½é¡µé¢
- å¯¹æ¥åç«¯APIæœåŠ¡
- å¼€å‘mota-tenant-serviceæœåŠ¡

---

**åˆ›å»ºæ—¥æœŸ**: 2026-01-30  
**å®Œæˆè¿›åº¦**: ç¬¬ä¸€é˜¶æ®µ 100%  
**é¢„è®¡ä¸‹ä¸€é˜¶æ®µ**: Week 3-4  
**ç»´æŠ¤å›¢é˜Ÿ**: MotaæŠ€æœ¯å›¢é˜Ÿ